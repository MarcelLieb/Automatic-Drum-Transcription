from main import main as train
from settings import Config

fast_decent_cnn = {
    'learning_rate': 0.0005060652326765156,
    'epochs': 20,
    'batch_size': 1024,
    'weight_decay': 2.7219485506860926e-05,
    'positive_weight': 1.0,
    'ema': False,
    'scheduler': False,
    'early_stopping': "None",
    'dataset_version': 'L',
    'splits': "(0.85, 0.15, 0.0)",
    'num_workers': 64,
    'min_save_score': 0.46,
    'test_batch_size': 1,
    'train_set': 'a2md_train',
    'model_settings': 'cnn',
    'peak_mean_range': 2,
    'peak_max_range': 2,
    'onset_cooldown': 0.021,
    'detect_tolerance': 0.025,
    'ignore_beats': True,
    'min_test_score': 0.48,
    'pr_points': 1000,
    'sample_rate': 44100,
    'hop_size': 441,
    'fft_size': 2048,
    'n_mels': 96,
    'center': True,
    'pad_mode': 'constant',
    'mel_min': 20.0,
    'mel_max': 20000.0,
    'normalize': False,
    'mapping': "Three class standard",
    'pad_annotations': True,
    'pad_value': 0.5,
    'time_shift': 0.015,
    'beats': False,
    'segment_type': 'frame',
    'frame_length': 0.2035858401526392,
    'frame_overlap': 0.1,
    'label_lead_in': 0.25,
    'label_lead_out': 0.1,
    'num_channels': 35,
    'num_residual_blocks': 0,
    'num_feature_layers': 3,
    'channel_multiplication': 2,
    'dropout': 0.1537819399758399,
    'causal': True,
    'flux': False,
    'activation': 'SELU',
    'classifier_dim': 174,
    'down_sample_factor': 4
}

best_model = best_crnn = {
    'activation': 'ELU',
    'batch_size': 9,
    'channel_multiplication': 4,
    'classifier_dim': 408,
    'dataset_version': 'S',
    'decoupled_weight_decay': True,
    'down_sample_factor': 3,
    'dropout': 0.0,
    'epochs': 20,
    'flux': False,
    'frame_length': 2.0,
    'frame_overlap': 0.2,
    'learning_rate': 0.00012,
    'n_mels': 128,
    'num_channels': 32,
    'num_conv_layers': 2,
    'num_rnn_layers': 5,
    'num_workers': 16,
    'pr_points': 1000,
    'rnn_units': 1337,
    'weight_decay': 0.0,
    'F-Score': 0.617189347743988,
    'dir_name': 'Oct06_11-36-53_marclie-desktop',
    'beats': False,
    'causal': True,
    'center': True,
    'detect_tolerance': 0.025,
    'ema': False,
    'fft_size': 2048,
    'full_length_test': True,
    'hop_size': 441,
    'ignore_beats': True,
    'label_lead_in': 0.25,
    'label_lead_out': 0.1,
    'mapping': 'Three class standard',
    'mel_max': 20000.0,
    'mel_min': 20.0,
    'min_save_score': 0.62,
    'min_test_score': 0.48,
    'model_settings': 'crnn',
    'normalize': False,
    'onset_cooldown': 0.021,
    'pad_annotations': True,
    'pad_mode': 'constant',
    'pad_value': 0.5,
    'peak_max_range': 2,
    'peak_mean_range': 2,
    'positive_weight': 1.0,
    'sample_rate': 44100,
    'scheduler': False,
    'segment_type': 'frame',
    'splits': '(0.85, 0.15, 0.0)',
    'test_batch_size': 1,
    'time_shift': 0.015,
    'train_set': 'a2md_train',
    'use_relative_pos': True
}

mamba_fast = {
    'activation': 'SELU',
    'backbone': 'cnn',
    'batch_size': 36,
    'beats': False,
    'beta_1': 0.9318222110119259,
    'beta_2': 0.9644253021697792,
    'causal': True,
    'center': True,
    'channel_multiplication': 1,
    'classifier_dim': 428,
    'd_conv': 4,
    'd_state': 64,
    'dataset_version': 'M',
    'decoupled_weight_decay': True,
    'detect_tolerance': 0.025,
    'down_sample_factor': 2,
    'dropout': 0.15000000000000002,
    'early_stopping': 7,
    'ema': True,
    'epochs': 30,
    'epsilon': 1e-08,
    'eval_set': 'A2MD',
    'expand': 2,
    'fft_size': 1024,
    'flux': True,
    'frame_length': 5.3,
    'frame_overlap': 1.5000000000000002,
    'full_length_test': False,
    'hidden_units': 209,
    'hop_size': 441,
    'ignore_beats': True,
    'label_lead_in': 0.25,
    'label_lead_out': 0.1,
    'learning_rate': 0.0006134886422263404,
    'mapping': 'three class standard',
    'mel_max': 20000.0,
    'mel_min': 20.0,
    'min_save_score': 0.0,
    'min_test_score': 0.0,
    'model_settings': 'mamba_fast',
    'n_layers': 13,
    'n_mels': 64,
    'normalize': False,
    'num_channels': 1,
    'num_conv_layers': 0,
    'onset_cooldown': 0.021,
    'pad_annotations': True,
    'pad_mode': 'constant',
    'pad_value': 0.5,
    'peak_max_range': 2,
    'peak_mean_range': 2,
    'positive_weight': 1.0,
    'power': 1,
    'pr_points': 1000,
    'sample_rate': 44100,
    'scheduler': False,
    'segment_type': 'frame',
    'splits': '(0.85, 0.15, 0.0)',
    'test_batch_size': 3,
    'test_sets': "('RBMA', 'MDB')",
    'time_shift': 0.015,
    'train_set': 'a2md_train',
    'weight_decay': 3.480668932284156e-05
}

crnn_small = {
    'activation': 'SELU',
    'batch_size': 10,
    'beats': False,
    'beta_1': 0.9133325608242332,
    'beta_2': 0.8718940833247785,
    'causal': True,
    'center': True,
    'channel_multiplication': 1,
    'classifier_dim': 1600,
    'dataset_version': 'M',
    'decoupled_weight_decay': True,
    'detect_tolerance': 0.025,
    'down_sample_factor': 4,
    'dropout': 0.0,
    'early_stopping': None,
    'ema': False,
    'epochs': 40,
    'epsilon': 6.276814435882056e-10,
    'eval_set': 'A2MD',
    'fft_size': 1024,
    'flux': True,
    'frame_length': 2.8,
    'frame_overlap': 0.7000000000000001,
    'full_length_test': True,
    'hop_size': 441,
    'ignore_beats': True,
    'label_lead_in': 0.25,
    'label_lead_out': 0.1,
    'learning_rate': 0.00037498101684973334,
    'mapping': 'three class standard',
    'mel_max': 20000.0,
    'mel_min': 20.0,
    'min_save_score': 0.0,
    'min_test_score': 0.0,
    'model_settings': 'crnn',
    'n_mels': 84,
    'normalize': False,
    'num_channels': 37,
    'num_conv_layers': 1,
    'num_rnn_layers': 4,
    'onset_cooldown': 0.021,
    'pad_annotations': True,
    'pad_mode': 'constant',
    'pad_value': 0.5,
    'peak_max_range': 2,
    'peak_mean_range': 2,
    'positive_weight': 1.0,
    'pr_points': 1000,
    'rnn_units': 158,
    'sample_rate': 44100,
    'scheduler': False,
    'segment_type': 'frame',
    'splits': '(0.85, 0.15, 0.0)',
    'test_batch_size': 1,
    'test_sets': "('RBMA', 'MDB')",
    'time_shift': 0.015,
    'train_set': 'a2md_train',
    'weight_decay': 1.9723653909356436e-05
}

final_experiment_params = {
    'Attention best': {
        'activation': 'SiLU',
        'batch_size': 5,
        'beats': False,
        'beta_1': 0.7328385949661181,
        'beta_2': 0.6712001349658206,
        'causal': True,
        'center': True,
        'channel_multiplication': 2,
        'context_size': 200,
        'dataset_version': 'M',
        'decoupled_weight_decay': False,
        'detect_tolerance': 0.025,
        'down_sample_factor': 4,
        'dropout': 0.35,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expansion_factor': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 3.6,
        'frame_overlap': 1.7000000000000002,
        'full_length_test': False,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.00019701284154262377,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'cnn_attention',
        'n_mels': 96,
        'normalize': False,
        'num_attention_blocks': 8,
        'num_channels': 24,
        'num_conv_layers': 3,
        'num_heads': 16,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 3,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'use_relative_pos': False,
        'weight_decay': 1.7037329843265721e-10
    },
    'Attention faster': {
        'activation': 'SiLU',
        'batch_size': 6,
        'beats': False,
        'beta_1': 0.8287987473771355,
        'beta_2': 0.7071391736328574,
        'causal': True,
        'center': True,
        'channel_multiplication': 2,
        'context_size': 200,
        'dataset_version': 'M',
        'decoupled_weight_decay': False,
        'detect_tolerance': 0.025,
        'down_sample_factor': 3,
        'dropout': 0.3,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expansion_factor': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 3.5,
        'frame_overlap': 1.7000000000000002,
        'full_length_test': False,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.0004126811339219242,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'cnn_attention',
        'n_mels': 96,
        'normalize': False,
        'num_attention_blocks': 8,
        'num_channels': 24,
        'num_conv_layers': 4,
        'num_heads': 16,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 3,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'use_relative_pos': False,
        'weight_decay': 1.862817349403482e-08
    },
    'Attention no conv': {
        'activation': 'SELU',
        'batch_size': 7,
        'beats': False,
        'beta_1': 0.7442999565869117,
        'beta_2': 0.8363966585913881,
        'causal': True,
        'center': True,
        'channel_multiplication': 3,
        'context_size': 200,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 3,
        'dropout': 0.4,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expansion_factor': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 3.6,
        'frame_overlap': 0.1,
        'full_length_test': False,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.000805177371831337,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'cnn_attention',
        'n_mels': 64,
        'normalize': False,
        'num_attention_blocks': 7,
        'num_channels': 48,
        'num_conv_layers': 0,
        'num_heads': 16,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 3,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'use_relative_pos': True,
        'weight_decay': 5.078243440707077e-10
    },
    'CRNN best': {
        'activation': 'SELU',
        'batch_size': 7,
        'beats': False,
        'beta_1': 0.8465832330435744,
        'beta_2': 0.9080326213407318,
        'causal': True,
        'center': True,
        'channel_multiplication': 4,
        'classifier_dim': 460,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 2,
        'dropout': 0.05,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1.889851774947018e-08,
        'eval_set': 'A2MD',
        'fft_size': 1024,
        'flux': True,
        'frame_length': 2.2,
        'frame_overlap': 0.2,
        'full_length_test': True,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 9.945282450500215e-05,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'crnn',
        'n_mels': 84,
        'normalize': False,
        'num_channels': 25,
        'num_conv_layers': 2,
        'num_rnn_layers': 4,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'rnn_units': 1090,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 1,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 2.0891162774860116e-05
    },
    'CRNN small': {
        'activation': 'SELU',
        'batch_size': 10,
        'beats': False,
        'beta_1': 0.9133325608242332,
        'beta_2': 0.8718940833247785,
        'causal': True,
        'center': True,
        'channel_multiplication': 1,
        'classifier_dim': 1600,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 4,
        'dropout': 0.0,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 6.276814435882056e-10,
        'eval_set': 'A2MD',
        'fft_size': 1024,
        'flux': True,
        'frame_length': 2.8,
        'frame_overlap': 0.7000000000000001,
        'full_length_test': True,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.00037498101684973334,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'crnn',
        'n_mels': 84,
        'normalize': False,
        'num_channels': 37,
        'num_conv_layers': 1,
        'num_rnn_layers': 4,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'pr_points': 1000,
        'rnn_units': 158,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 1,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 1.9723653909356436e-05
    },
    'CRNN no conv': {
        'activation': 'ELU',
        'batch_size': 21,
        'beats': False,
        'beta_1': 0.9073580092748167,
        'beta_2': 0.9746851877009004,
        'causal': True,
        'center': True,
        'channel_multiplication': 2,
        'classifier_dim': 369,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 3,
        'dropout': 0.35,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1.737889172996994e-07,
        'eval_set': 'A2MD',
        'fft_size': 1024,
        'flux': False,
        'frame_length': 1.6,
        'frame_overlap': 0.5,
        'full_length_test': True,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.00027721229048805775,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'crnn',
        'n_mels': 84,
        'normalize': False,
        'num_channels': 21,
        'num_conv_layers': 0,
        'num_rnn_layers': 3,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'rnn_units': 609,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 1,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 7.688941212161995e-09
    },
    'Mamba best': {
        'activation': 'ReLU',
        'backbone': 'cnn',
        'batch_size': 34,
        'beats': False,
        'beta_1': 0.874396896983057,
        'beta_2': 0.8996510808804896,
        'causal': True,
        'center': True,
        'channel_multiplication': 2,
        'classifier_dim': 55,
        'd_conv': 4,
        'd_state': 32,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 1,
        'dropout': 0.25,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expand': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 5.9,
        'frame_overlap': 1.4000000000000001,
        'full_length_test': False,
        'hidden_units': 871,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.00013634366627342828,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'mamba_fast',
        'n_layers': 11,
        'n_mels': 96,
        'normalize': False,
        'num_channels': 48,
        'num_conv_layers': 2,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 1,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 6.880469759057856e-06
    },
    'Mamba fast': {
        'activation': 'SELU',
        'backbone': 'cnn',
        'batch_size': 36,
        'beats': False,
        'beta_1': 0.9318222110119259,
        'beta_2': 0.9644253021697792,
        'causal': True,
        'center': True,
        'channel_multiplication': 1,
        'classifier_dim': 428,
        'd_conv': 4,
        'd_state': 64,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 2,
        'dropout': 0.15000000000000002,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expand': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 5.3,
        'frame_overlap': 1.5000000000000002,
        'full_length_test': False,
        'hidden_units': 209,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 0.0006134886422263404,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'mamba_fast',
        'n_layers': 13,
        'n_mels': 64,
        'normalize': False,
        'num_channels': 1,
        'num_conv_layers': 0,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 3,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 3.480668932284156e-05
    },
    'Mamba no conv': {
        'activation': 'ReLU',
        'backbone': 'cnn',
        'batch_size': 21,
        'beats': False,
        'beta_1': 0.8531761664502059,
        'beta_2': 0.9965081975134672,
        'causal': True,
        'center': True,
        'channel_multiplication': 1,
        'classifier_dim': 124,
        'd_conv': 4,
        'd_state': 64,
        'dataset_version': 'M',
        'decoupled_weight_decay': True,
        'detect_tolerance': 0.025,
        'down_sample_factor': 2,
        'dropout': 0.30000000000000004,
        'early_stopping': None,
        'ema': True,
        'epochs': 40,
        'epsilon': 1e-08,
        'eval_set': 'A2MD',
        'expand': 2,
        'fft_size': 1024,
        'flux': True,
        'frame_length': 4.0,
        'frame_overlap': 0.4,
        'full_length_test': False,
        'hidden_units': 1153,
        'hop_size': 441,
        'ignore_beats': True,
        'label_lead_in': 0.25,
        'label_lead_out': 0.1,
        'learning_rate': 7.125933646259259e-05,
        'mapping': 'three class standard',
        'mel_max': 20000.0,
        'mel_min': 20.0,
        'min_save_score': 0.0,
        'min_test_score': 0.0,
        'model_settings': 'mamba_fast',
        'n_layers': 14,
        'n_mels': 96,
        'normalize': False,
        'num_channels': 1,
        'num_conv_layers': 0,
        'onset_cooldown': 0.021,
        'pad_annotations': True,
        'pad_mode': 'constant',
        'pad_value': 0.5,
        'peak_max_range': 2,
        'peak_mean_range': 2,
        'positive_weight': 1.0,
        'power': 1,
        'pr_points': 1000,
        'sample_rate': 44100,
        'scheduler': False,
        'segment_type': 'frame',
        'splits': '(0.85, 0.15, 0.0)',
        'test_batch_size': 1,
        'test_sets': "('RBMA', 'MDB')",
        'time_shift': 0.015,
        'train_set': 'a2md_train',
        'weight_decay': 2.4598108954923945e-08
    }
}


def main():
    config = Config.from_flat_dict(best_model)
    train(config)


if __name__ == '__main__':
    main()
